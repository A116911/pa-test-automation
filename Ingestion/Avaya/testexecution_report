Mounts successfully refreshed.


******************START TESTCASE EXECUTION*************************
Database table name: Sessions_month_1
Extract Date: 2019-07-08
CSV File names: 
wasbs://others@edplztstsa00.blob.core.windows.net/avaya/Sessions_month_1/1/extract_date=2019-07-08/sessions_month_1_201907081100000000000009_2735918.csv.bz2
Test case execution date: 2019-07-10T04:08:40.002


Execute count comparison between Database table and CSV
Database table Count is : 2735918
CSV Count is : 2735918
Data count matching for both Database table and CSV --- PASS.
*******************************************


Execute data comparison between Database table and CSV 
Following transformations were applied on the DB table dataframe to handle known issues: 
+----------------+----------+-------------------------------------------------------------------------------------------+-----------------------------+------------------------------------------------+
|table_name      |dataorigin|column_name                                                                                |function                     |issuearea                                       |
+----------------+----------+-------------------------------------------------------------------------------------------+-----------------------------+------------------------------------------------+
|Sessions_month_1|database  |local_start_time;local_end_time;system_start_time;system_end_time;creation_date;remarked_at|drop_columns                 |Timestamp format issue with Databricks          |
|Sessions_month_1|database  |ANI;DNIS;PBX_id;switch_call_id;string_extension;remark;p18_value                           |trim_columns                 |Space gets truncated by Ingestion process in csv|
|Sessions_month_1|database  |ANI;DNIS;PBX_id;switch_call_id;string_extension;remark;p18_value                           |replace_emptystring_with_null|Empty string in database is null in csv         |
+----------------+----------+-------------------------------------------------------------------------------------------+-----------------------------+------------------------------------------------+

Following transformations were applied on the CSV dataframe to handle known issues: 
+----------------+----------+------------------------------------+-----------------------------+------------------------------------------------+
|table_name      |dataorigin|column_name                         |function                     |issuearea                                       |
+----------------+----------+------------------------------------+-----------------------------+------------------------------------------------+
|Sessions_month_1|csv       |_c120                               |drop_columns                 |Timestamp format issue with Databricks          |
|Sessions_month_1|csv       |_c5;_c6;_c8;_c9;_c117;_c116         |drop_columns                 |Timestamp format issue with Databricks          |
|Sessions_month_1|csv       |_c14;_c15;_c16;_c22;_c119;_c114;_c81|trim_columns                 |Space gets truncated by Ingestion process in csv|
|Sessions_month_1|csv       |_c14;_c15;_c16;_c22;_c119;_c114;_c81|replace_emptystring_with_null|Empty string in database is null in csv         |
+----------------+----------+------------------------------------+-----------------------------+------------------------------------------------+

Dataframe comparison between source and target usig except function
Database table minus CSV comparison output using scala except function: 
+-------+-------------+-------------+---+----------------------+-----------+-----------+-------------+--------+-----------+---+----+------+--------+---------+---------+---------+---------+--------------+------------------+------------------+---------------------+---------------------+-------------------------+---------------+---------------+-----+--------+--------+--------+--------+--------+-----------+-----------+-----------+-----------+-----------+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+--------+--------+--------+--------+--------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------+-----------+--------------------+----------------+
|sid_key|month_of_year|contact_db_id|sid|local_time_by_hour_key|wrapup_time|contact_key|sess_duration|unit_num|channel_num|ANI|DNIS|PBX_id|user_key|direction|extension|is_screen|switch_id|switch_call_id|num_of_agent_cross|num_of_other_cross|percent_of_agent_call|percent_of_other_call|percent_of_mutual_silence|number_of_holds|total_hold_time|il_id|PCD_1_ID|PCD_2_ID|PCD_3_ID|PCD_4_ID|PCD_5_ID|PCD_1_value|PCD_2_value|PCD_3_value|PCD_4_value|PCD_5_value|p1_key|p2_key|p3_key|p4_key|p5_key|p6_key|p7_key|p8_key|p9_key|p10_key|p11_key|p12_key|p13_key|p14_key|p15_key|p16_key|p17_key|p18_key|p19_key|p20_key|p21_key|p22_key|p23_key|p1_value|p2_value|p3_value|p4_value|p5_value|p6_value|p7_value|p8_value|p9_value|p10_value|p11_value|p12_value|p13_value|p14_value|p15_value|p16_value|p17_value|p18_value|p19_value|p20_value|p21_value|p22_value|p23_value|p24_value|p25_value|p1_content|p2_content|p3_content|p4_content|p5_content|p6_content|p7_content|p8_content|p9_content|p10_content|p11_content|p12_content|p13_content|p14_content|p15_content|p16_content|p17_content|p18_content|p19_content|p20_content|p21_content|p22_content|p23_content|p24_content|p25_content|remark|remarked_by|string_extension_key|string_extension|
+-------+-------------+-------------+---+----------------------+-----------+-----------+-------------+--------+-----------+---+----+------+--------+---------+---------+---------+---------+--------------+------------------+------------------+---------------------+---------------------+-------------------------+---------------+---------------+-----+--------+--------+--------+--------+--------+-----------+-----------+-----------+-----------+-----------+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+--------+--------+--------+--------+--------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------+-----------+--------------------+----------------+
+-------+-------------+-------------+---+----------------------+-----------+-----------+-------------+--------+-----------+---+----+------+--------+---------+---------+---------+---------+--------------+------------------+------------------+---------------------+---------------------+-------------------------+---------------+---------------+-----+--------+--------+--------+--------+--------+-----------+-----------+-----------+-----------+-----------+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+--------+--------+--------+--------+--------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+----------+----------+----------+----------+----------+----------+----------+----------+----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------+-----------+--------------------+----------------+

Database table minus CSV mismatch count : 0
CSV VS Database table comparison output using scala except function:
+---+---+---+---+---+---+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
|_c0|_c1|_c2|_c3|_c4|_c7|_c10|_c11|_c12|_c13|_c14|_c15|_c16|_c17|_c18|_c19|_c20|_c21|_c22|_c23|_c24|_c25|_c26|_c27|_c28|_c29|_c30|_c31|_c32|_c33|_c34|_c35|_c36|_c37|_c38|_c39|_c40|_c41|_c42|_c43|_c44|_c45|_c46|_c47|_c48|_c49|_c50|_c51|_c52|_c53|_c54|_c55|_c56|_c57|_c58|_c59|_c60|_c61|_c62|_c63|_c64|_c65|_c66|_c67|_c68|_c69|_c70|_c71|_c72|_c73|_c74|_c75|_c76|_c77|_c78|_c79|_c80|_c81|_c82|_c83|_c84|_c85|_c86|_c87|_c88|_c89|_c90|_c91|_c92|_c93|_c94|_c95|_c96|_c97|_c98|_c99|_c100|_c101|_c102|_c103|_c104|_c105|_c106|_c107|_c108|_c109|_c110|_c111|_c112|_c113|_c114|_c115|_c118|_c119|
+---+---+---+---+---+---+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
+---+---+---+---+---+---+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+

CSV minus Database table mismatch count : 0
Database data matched with CSV data successfully - PASS



Total time in minutes for current test case is: 7.0

******************END TESTCASE EXECUTION*************************

Total time in minutes for entire test suite: 9.0

#################################################################################